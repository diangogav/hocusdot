#!/usr/bin/env zsh

echo "üîç Verificando modernizaci√≥n de Zsh...\n"

# Colors
GREEN='\033[0;32m'
RED='\033[0;31m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

check_command() {
  if command -v $1 &> /dev/null; then
    echo "${GREEN}‚úì${NC} $1 instalado"
    return 0
  else
    echo "${RED}‚úó${NC} $1 NO instalado"
    return 1
  fi
}

check_file() {
  if [ -f "$1" ]; then
    echo "${GREEN}‚úì${NC} $2"
    return 0
  else
    echo "${RED}‚úó${NC} $2 NO encontrado"
    return 1
  fi
}

echo "üì¶ Verificando herramientas instaladas:"
check_command "fnm"
check_command "zoxide"
check_command "starship"
check_command "lsd"
check_command "bat"
check_command "fzf"

echo "\nüìÅ Verificando archivos de configuraci√≥n:"
check_file "$HOME/.dotfiles/terminal/zsh/zshrc" "zshrc"
check_file "$HOME/.dotfiles/terminal/zsh/zshrc.backup" "zshrc.backup"
check_file "$HOME/.dotfiles/terminal/nodejs/fnm.zsh" "fnm.zsh"
check_file "$HOME/.dotfiles/terminal/aliases" "aliases"

echo "\n‚öôÔ∏è  Verificando configuraci√≥n de historial:"
if grep -q "HISTSIZE=50000" ~/.dotfiles/terminal/zsh/zshrc; then
  echo "${GREEN}‚úì${NC} HISTSIZE configurado a 50000"
else
  echo "${RED}‚úó${NC} HISTSIZE no actualizado"
fi

if grep -q "EXTENDED_HISTORY" ~/.dotfiles/terminal/zsh/zshrc; then
  echo "${GREEN}‚úì${NC} Opciones avanzadas de historial configuradas"
else
  echo "${RED}‚úó${NC} Opciones de historial no configuradas"
fi

echo "\nüîå Verificando zinit:"
if [ -d "${HOME}/.local/share/zinit/zinit.git" ]; then
  echo "${GREEN}‚úì${NC} Zinit instalado"
else
  echo "${YELLOW}‚ö†${NC}  Zinit se instalar√° en el pr√≥ximo inicio de zsh"
fi

echo "\nüìä Informaci√≥n del sistema:"
echo "Shell actual: $SHELL"
echo "Versi√≥n de Zsh: $(zsh --version)"

echo "\nüöÄ Pr√≥ximos pasos:"
echo "1. Ejecuta: ${YELLOW}source ~/.zshrc${NC} o ${YELLOW}exec zsh${NC}"
echo "2. La primera vez, zinit descargar√° los plugins (puede tardar ~30 segundos)"
echo "3. Prueba los nuevos comandos:"
echo "   - ${YELLOW}z <directorio>${NC} - Navegaci√≥n inteligente con zoxide"
echo "   - ${YELLOW}zi${NC} - B√∫squeda interactiva de directorios"
echo "   - ${YELLOW}fnm list${NC} - Ver versiones de Node.js instaladas"
echo "   - ${YELLOW}fnm install <version>${NC} - Instalar versi√≥n de Node.js"
echo "\n‚ú® ¬°Modernizaci√≥n completada!"
